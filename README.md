# 会計王 仕訳データ作成ツール 📊

ExcelファイルをアップロードしてChatGPT APIで解析し、会計王の仕訳データ受入形式のCSVファイルに変換するWebアプリケーションです。

## 機能

- 📤 **Excelファイルのアップロード**: 取引データを含むExcelファイルを簡単にアップロード
- 🤖 **ChatGPT自動変換**: OpenAI GPT-4を使用して自動的に仕訳データに変換
- ✏️ **データ編集機能**: 変換後のデータをブラウザ上で直接編集可能
- 📥 **CSV出力**: 会計王の仕訳データ受入形式でCSVファイルをダウンロード
- 🎨 **使いやすいUI**: Streamlitによる直感的なWebインターフェース

## 前提条件

- Python 3.8以上
- OpenAI APIキー ([取得方法](https://platform.openai.com/api-keys))

## インストール

### 1. リポジトリのクローン

```bash
git clone https://github.com/yourusername/AIGen-kaikeio.git
cd AIGen-kaikeio
```

### 2. 仮想環境の作成(推奨)

```bash
python -m venv venv

# Windowsの場合
venv\Scripts\activate

# Mac/Linuxの場合
source venv/bin/activate
```

### 3. 必要なパッケージのインストール

```bash
pip install -r requirements.txt
```

### 4. 環境変数の設定

プロジェクトルートに`.env`ファイルを作成し、OpenAI APIキーを設定します:

```
OPENAI_API_KEY=your_openai_api_key_here
```

## 使い方

### アプリの起動

```bash
streamlit run app.py
```

ブラウザが自動的に開き、アプリケーションが表示されます。  
通常は `http://localhost:8501` でアクセスできます。

### 基本的なワークフロー

1. **APIキーの設定**
   - サイドバーにOpenAI APIキーを入力(または.envファイルで設定)

2. **Excelファイルのアップロード**
   - 「データアップロード」タブでExcelファイルを選択
   - シートを選択してデータプレビューを確認

3. **ChatGPTで変換**
   - 「ChatGPTで仕訳データに変換」ボタンをクリック
   - AIが自動的に会計王形式に変換

4. **データの確認・編集**
   - 「データ編集」タブで変換結果を確認
   - 必要に応じて直接編集

5. **CSVファイルのダウンロード**
   - 「ダウンロード」タブでCSVファイルを取得
   - 会計王の「仕訳データ受入」機能でインポート

## 会計王 仕訳データ形式

このツールは以下の形式でCSVファイルを出力します:

| 列名 | 説明 | 形式 |
|------|------|------|
| 伝票日付 | 取引日付 | YYYYMMDD |
| 伝票番号 | 連番 | 数値 |
| 借方科目コード | 勘定科目コード | 3-4桁の数字 |
| 借方科目名 | 勘定科目名 | テキスト |
| 借方金額 | 借方金額 | 数値 |
| 借方税区分 | 税区分(0=対象外、10=課税売上) | 数値 |
| 借方税額 | 消費税額 | 数値 |
| 貸方科目コード | 勘定科目コード | 3-4桁の数字 |
| 貸方科目名 | 勘定科目名 | テキスト |
| 貸方金額 | 貸方金額 | 数値 |
| 貸方税区分 | 税区分(0=対象外、10=課税売上) | 数値 |
| 貸方税額 | 消費税額 | 数値 |
| 摘要 | 取引内容の説明 | テキスト |

その他、部門コード・補助科目などの列も含まれます。

## サンプルファイル

`template_kaikei.csv` に会計王形式のサンプルCSVが含まれています。参考にしてください。

## トラブルシューティング

### パッケージのインポートエラー

```bash
pip install --upgrade -r requirements.txt
```

### OpenAI APIエラー

- APIキーが正しく設定されているか確認
- OpenAIアカウントの残高を確認
- APIキーの権限を確認

### Excelファイルの読み込みエラー

- ファイル形式が`.xlsx`または`.xls`であることを確認
- ファイルが破損していないか確認
- 別のシートを選択してみる

## 技術スタック

- **Streamlit**: Webアプリケーションフレームワーク
- **Pandas**: データ処理・分析
- **OpenAI API**: ChatGPT連携
- **OpenPyXL**: Excel ファイル読み込み

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 注意事項

- このツールはOpenAI APIを使用するため、API使用料が発生します
- 変換結果は必ず内容を確認してから会計王にインポートしてください
- 重要な会計データは必ずバックアップを取ってから作業してください
- 会計王のバージョンによってデータ形式が異なる場合があります

## サポート

問題が発生した場合は、GitHubのIssuesページで報告してください。

## 更新履歴

### v1.0.0 (2025-11-01)
- 初回リリース
- Excel to 会計王CSV変換機能
- ChatGPT API連携
- データ編集機能

---

© 2025 会計王仕訳データ作成ツール